<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>会計履歴</title>
    <link rel="stylesheet" href="/css/payment-history.css">
</head>
<body>
<h1>会計履歴</h1>
<table>
    <thead>
    <tr>
        <th>日時</th>
        <th>席</th>
        <th>合計</th>
        <th>担当</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="payment : ${payments}">
        <td th:text="${#temporals.format(payment.paymentTime, 'yyyy-MM-dd HH:mm')}"></td>
        <td th:text="${payment.visit.seat.seatName}"></td>
        <td th:text="${#numbers.formatDecimal(payment.total,0,0)} + '円'"></td>
        <td th:text="${payment.cashier != null ? payment.cashier.userName : ''}"></td>
    </tr>
    </tbody>
</table>
<<<<<<< codex_test
<div id="detailModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="modalBody"></div>
    </div>
</div>
<script>
const modal = document.getElementById('detailModal');
const modalBody = document.getElementById('modalBody');
const closeBtn = modal.querySelector('.close');

closeBtn.onclick = () => {
    modal.style.display = 'none';
};

window.onclick = event => {
    if (event.target === modal) {
        modal.style.display = 'none';
    }
};

document.querySelectorAll('#historyTable tbody tr').forEach(row => {
    row.addEventListener('click', () => {
        const id = row.dataset.paymentId;
        fetch(`/payments/history/${id}`)
            .then(res => res.json())
            .then(data => {
                let html = `<h2>会計詳細</h2>`;
                html += `<p>席: ${data.seatName}</p>`;
                html += `<p>合計: ${data.total}円</p>`;
                html += `<table><tr><th>商品</th><th>数量</th><th>小計</th></tr>`;
                data.details.forEach(d => {
                    html += `<tr><td>${d.menuName}</td><td>${d.quantity}</td><td>${d.subtotal}円</td></tr>`;
                });
                html += `</table>`;
                modalBody.innerHTML = html;
                modal.style.display = 'block';
            });
    });
});
</script>
=======
>>>>>>> c6a4dcf Add payment detail retrieval from history
</body>
</html>
