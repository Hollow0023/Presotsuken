<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>メニューグループ追加</title>
  <script th:inline="javascript">
    const storeId = /*[[${storeId}]]*/ null;
  </script>
</head>
<body>

<h2>メニューグループ追加</h2>

<div>
  <input type="text" id="groupNameInput" placeholder="グループ名を入力" />
  <button onclick="submitGroup()">追加</button>
</div>

<script>
  function submitGroup() {
    const groupName = document.getElementById("groupNameInput").value.trim();
    if (!groupName) {
      alert("グループ名を入力してください");
      return;
    }

	fetch("/menu/group/api/add", {
	    method: "POST",
	    headers: { "Content-Type": "application/json" },
	    body: JSON.stringify({ storeId: storeId, groupName: groupName })
	})
    .then(res => {
      if (!res.ok) throw new Error("サーバーエラー: " + res.status);
      return res.json();
    })
    .then(data => {
      if (data.success) {
        alert("追加しました！");
        window.location.href = "/";
      } else if (data.error === "duplicate") {
        alert("そのグループ名は既に存在しています。");
      } else if (data.error === "not_found") {
        alert("店舗情報が見つかりません。");
      } else {
        alert("未知のエラーが発生しました。");
      }
    })
    .catch(err => {
      console.error(err);
      alert("通信エラーが発生しました。");
    });
  }
</script>

</body>
</html>
