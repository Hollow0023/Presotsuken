<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>売上分析（時間範囲指定）</title>
    <link rel="stylesheet" href="/css/sales-analysis.css">
    <!-- バーガーメニューのCSS -->
    <link rel="stylesheet" href="/css/components/navigation.css">
</head>
<body>
    <!-- バーガーメニューボタン -->
    <div th:replace="~{fragments/burger-menu :: burger-button}"></div>
    
    <!-- バーガーメニュードロワー -->
    <div th:replace="~{fragments/burger-menu :: burger-drawer}"></div>
    
<h1>売上分析（時間範囲指定）</h1>
<a href="/sales-analysis">← 日付別分析に戻る</a>

<form id="timeRangeForm" method="get" action="/sales-analysis/time-range">
    <fieldset>
        <legend>分析期間</legend>
        <label>開始日: <input type="date" name="startDate" th:value="${startDate}" required></label>
        <label>開始時刻: <input type="time" name="startTime" th:value="${startTime}" required></label>
        <br>
        <label>終了日: <input type="date" name="endDate" th:value="${endDate}" required></label>
        <label>終了時刻: <input type="time" name="endTime" th:value="${endTime}" required></label>
        <br>
        <button type="submit">表示</button>
    </fieldset>
</form>

<p>期間: <span th:text="${startDate}"></span> <span th:text="${startTime}"></span> ～ <span th:text="${endDate}"></span> <span th:text="${endTime}"></span></p>

<table id="analysisTable">
    <thead>
    <tr>
        <th>時間帯</th>
        <th>客数</th>
        <th>客単価(税抜)</th>
        <th>客単価(税込)</th>
        <th>売上(税抜)</th>
        <th>売上(税込)</th>
        <th>累計(税抜)</th>
        <th>累計(税込)</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="row : ${hourlyData}">
        <td th:text="${row.hour} + ':00 - ' + (${row.hour}+1) + ':00'"></td>
        <td th:text="${row.customers}"></td>
        <td><span th:text="${#numbers.formatDecimal(row.customerUnitPriceWithoutTax,0,0)}"></span>円</td>
        <td><span th:text="${#numbers.formatDecimal(row.customerUnitPriceWithTax,0,0)}"></span>円</td>
        <td><span th:text="${#numbers.formatDecimal(row.hourSalesWithoutTax,0,0)}"></span>円</td>
        <td><span th:text="${#numbers.formatDecimal(row.hourSalesWithTax,0,0)}"></span>円</td>
        <td><span th:text="${#numbers.formatDecimal(row.cumulativeSalesWithoutTax,0,0)}"></span>円</td>
        <td><span th:text="${#numbers.formatDecimal(row.cumulativeSalesWithTax,0,0)}"></span>円</td>
    </tr>
    </tbody>
    <tfoot th:if="${totalRow != null}">
    <tr class="total-row">
        <td><strong>合計</strong></td>
        <td><strong th:text="${totalRow.customers}"></strong></td>
        <td><strong><span th:text="${#numbers.formatDecimal(totalRow.customerUnitPriceWithoutTax,0,0)}"></span>円</strong></td>
        <td><strong><span th:text="${#numbers.formatDecimal(totalRow.customerUnitPriceWithTax,0,0)}"></span>円</strong></td>
        <td><strong><span th:text="${#numbers.formatDecimal(totalRow.hourSalesWithoutTax,0,0)}"></span>円</strong></td>
        <td><strong><span th:text="${#numbers.formatDecimal(totalRow.hourSalesWithTax,0,0)}"></span>円</strong></td>
        <td><strong><span th:text="${#numbers.formatDecimal(totalRow.cumulativeSalesWithoutTax,0,0)}"></span>円</strong></td>
        <td><strong><span th:text="${#numbers.formatDecimal(totalRow.cumulativeSalesWithTax,0,0)}"></span>円</strong></td>
    </tr>
    </tfoot>
</table>

<!-- バーガーメニューのJavaScript -->
<div th:replace="~{fragments/burger-menu :: burger-menu-js}"></div>
</body>
</html>
