<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/common-head :: common-head('Ê≥®ÊñáÁîªÈù¢', ${{order-refactored.css}})}"></head>

<body>
    <!-- „Éò„ÉÉ„ÉÄ„ÉºÈÉ®ÂàÜ -->
    <div class="page-header">
        <div id="seatInfo" class="page-title"></div>
        <div>
            <button class="call-button" type="button" onclick="sendCallRequest()">Â∫óÂì°„ÇíÂëº„Å∂</button>
            <button id="historyToggleButton" class="history-button" onclick="toggleHistory()">Ê≥®ÊñáÂ±•Ê≠¥</button>
            <button id="cartToggleButton" class="cart-button" onclick="toggleCart()">üõí „Ç´„Éº„Éà„ÇíË¶ã„Çã</button>
        </div>
    </div>

    <main>
        <!-- „É°„Éã„É•„Éº„Çø„Éñ -->
        <div class="menu-tabs">
            <div id="backToSeatList" style="display: none; margin-bottom: 12px;">
                <a id="backToSeatList" href="/">‚Üê Â∫ßÂ∏≠„É™„Çπ„Éà„Å´Êàª„Çã</a>
            </div>
            <div th:each="group : ${menuGroups}"
                th:data-group-id="${group.groupId}" 
                th:text="${group.groupName}"
                th:data-is-plan-target="${group.isPlanTarget}"
                class="menu-tab"></div>
        </div>

        <!-- „É°„Éã„É•„Éº„É™„Çπ„Éà -->
        <div class="menu-list" id="menuList">
            <div th:each="menu : ${menus}" class="menu-item"
                th:data-group-id="${menu.menuGroupId}"
                th:data-is-plan-target="${menu.menuGroupIsPlanTarget}">
                
                <div class="menu-image-wrapper">
                    <img th:src="@{${menu.menuImage}}"
                        onerror="this.onerror=null;this.src='/images/noimage.jpg'"
                        alt="„É°„Éã„É•„ÉºÁîªÂÉè" />
                    <button class="info-btn" th:if="${menu.description != null}"
                        th:attr="data-name=${menu.menuName}, data-desc=${menu.description}">
                        i</button>
                </div>
                
                <div class="menu-content">
                    <div class="menu-name" th:text="${menu.menuName}"></div>
                    <div class="menu-price" th:text="${#numbers.formatInteger(menu.priceWithTax, 0) + 'ÂÜÜÔºàÁ®éËæºÔºâ'}"></div>
                </div>

                <!-- „É°„Éã„É•„ÉºË©≥Á¥∞ÔºàÂ±ïÈñãÊôÇ„Å´Ë°®Á§∫Ôºâ -->
                <div class="menu-detail">
                    <!-- „Ç™„Éó„Ç∑„Éß„É≥ÈÅ∏Êäû -->
                    <div th:if="${menu.options != null and #lists.size(menu.options) > 0}">
                        <div th:each="option : ${menu.options}" class="option-group">
                            <div class="detail-label" th:text="${option.optionName}"></div>
                            <select class="option-select form-control" th:attr="data-option-id=${option.optionId}">
                                <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                <option th:each="item : ${option.items}"
                                    th:value="${item.optionItemId}"
                                    th:text="${item.itemName + ' (+' + #numbers.formatInteger(item.additionalPrice, 0) + 'ÂÜÜ)'}"></option>
                            </select>
                        </div>
                    </div>

                    <!-- Êï∞ÈáèÈÅ∏Êäû -->
                    <div class="detail-section">
                        <div class="detail-label">Êï∞Èáè</div>
                        <div class="quantity-controls">
                            <button type="button" class="quantity-btn minus-btn">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" readonly>
                            <button type="button" class="quantity-btn plus-btn">+</button>
                        </div>
                    </div>

                    <!-- „Ç´„Éº„Éà„Å´ËøΩÂä†„Éú„Çø„É≥ -->
                    <button class="add-cart-btn"
                        th:attr="data-menu-id=${menu.menuId}, 
                                data-tax-rate-id=${menu.taxRateId}, 
                                data-price=${menu.price}, 
                                data-name=${menu.menuName}">
                        „Ç´„Éº„Éà„Å´ËøΩÂä†
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- „Ç´„Éº„Éà„Éë„Éç„É´ -->
    <div th:replace="~{fragments/modals :: cart-panel}"></div>

    <!-- Ê≥®ÊñáÂ±•Ê≠¥„É¢„Éº„ÉÄ„É´ -->
    <div th:replace="~{fragments/modals :: history-modal}"></div>

    <!-- „Éà„Éº„Çπ„ÉàÈÄöÁü• -->
    <div id="toast" class="toast"></div>

    <!-- „Çπ„ÇØ„É™„Éó„Éà -->
    <script th:inline="javascript">
        window.seatIdFromModel = /*[[${seatId}]]*/ 0;
        console.log(seatIdFromModel);
    </script>
    
    <div th:replace="~{fragments/common-scripts :: websocket-scripts}"></div>
    <div th:replace="~{fragments/common-scripts :: printer-scripts}"></div>
    <div th:replace="~{fragments/common-scripts :: call-system-scripts}"></div>
    <div th:replace="~{fragments/common-scripts :: common-scripts(${{order.js}})}"></div>

</body>
</html>